{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"F:\\\\StudentAffairs\\\\students\\\\students\\\\pages\\\\authentication\\\\sign-in\\\\index.tsx\";\nimport React, { useEffect, useState } from \"react\";\nimport { Formik, Form } from \"formik\";\nimport * as Yup from \"yup\";\nimport { useRouter } from \"next/router\"; // Authentication layout components\n\nimport CoverLayout from \"../../../components/CoverLayout\";\nimport { Box, Typography, TextField, Select, MenuItem } from \"@material-ui/core\";\nimport { Switch } from \"@material-ui/core\";\nimport SuiButton from \"../../../components/SuiButton\";\nimport \"../../../assets/css/main.css\";\nimport { useSession } from \"next-auth/react\";\nimport { selectSessionKey, useAppDispatch, useAppSelector, setSessionKey, updateProfile } from \"../../../redux\";\nimport LoginService from \"../../../Services/LoginService\";\nimport { useTranslation } from \"../../../Utility/Translations/useTranslation\"; // Images\n\nconst bg7 = require(\"./../../../assets/img/curved-images/HIAST.jpg\");\n\nfunction SignIn() {\n  const {\n    translate\n  } = useTranslation();\n  const {\n    locale\n  } = useRouter();\n  const dispatch = useAppDispatch();\n  const {\n    0: rememberMe,\n    1: setRememberMe\n  } = useState(true);\n  const {\n    0: _currentSessionKey,\n    1: setCurrentSessionKey\n  } = useState(\"\");\n  const {\n    data: session\n  } = useSession();\n  const isUser = !!(session !== null && session !== void 0 && session.user);\n  const sessionKey = useAppSelector(selectSessionKey);\n  const userProfile = useAppSelector(updateProfile);\n  useEffect(() => {\n    // console.log(\"session changed\", sessionKey);\n    // console.log(\"user profile changed\", userProfile);\n    if (!!sessionKey) router.push(\"/students_affairs/dashboard\");\n  }, [sessionKey]);\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: years,\n    1: setYears\n  } = useState([]);\n  const {\n    0: selectedYear,\n    1: setSelectedYear\n  } = useState(\"\");\n  const initialValues = {\n    username: \"\",\n    // email: \"\",\n    password: \"\",\n    rememberMe: false\n  };\n\n  const handleSetRememberMe = () => setRememberMe(!rememberMe);\n\n  const router = useRouter();\n\n  async function fetchApi() {\n    let data = await LoginService.GetYears();\n    console.log(\"years\", data);\n    return data;\n  }\n\n  const handleChangeYear = event => {\n    setSelectedYear(event.target.value);\n  };\n\n  useEffect(() => {\n    setLoading(true);\n  }, []);\n  const {\n    status,\n    data\n  } = useSession(); // useEffect(() => {\n  //   console.log(\"status\", status);\n  //   console.log(\"data\", data);\n  //   if (status === \"authenticated\") router.replace(\"/\");\n  // }, [status]);\n\n  const SignInSchema = Yup.object().shape({\n    username: Yup.string().required(translate(\"{0} is required\", \"Username\")),\n    // .required(\"Email is required\"),\n    // email: Yup.string()\n    //   .email(\"Must be a valid email\")\n    //   .required(\"Email is required\"),\n    password: Yup.string().required(translate(\"{0} is required\", \"Password\")).min(4, translate(\"Password is too short - should be {0} chars minimum\", \"4\", false))\n  });\n\n  const submitForm = async (values, setSubmitting) => {\n    console.log(\"values\", values);\n    LoginService.Login({\n      email: values.username,\n      password: values.password\n    }).then(res => {\n      console.log(res);\n\n      if (res.success) {\n        console.log(\"sessionKey\", res.result.token);\n        console.log(\"userProfile\", res.result);\n        dispatch(setSessionKey(res.result.token));\n        dispatch(updateProfile(res.result));\n      }\n\n      console.log(\"sessionKey\", sessionKey);\n      console.log(\"userProfile\", userProfile);\n    }).catch(err => console.error(err)); // const resp = await signIn(\"credentials\", {\n    //   email: values.username,\n    //   password: values.password,\n    //   redirect: false,\n    // });\n    // console.log(resp);\n    // if (resp.ok) {\n    //   router.push(\"/student_affairs/dashboard\");\n    // } else {\n    // }\n  };\n\n  const navigateToDashboard = () => {\n    router.push(\"/students_affairs/dashboard\");\n  };\n\n  return !!sessionKey ? /*#__PURE__*/_jsxDEV(CoverLayout, {\n    title: translate(\"Welcome\"),\n    description: translate(\"Enter your credentials to sign in\"),\n    image: bg7,\n    children: /*#__PURE__*/_jsxDEV(Box, {\n      children: /*#__PURE__*/_jsxDEV(Formik, {\n        initialValues: initialValues,\n        validationSchema: SignInSchema,\n        onSubmit: (values, {\n          setSubmitting\n        }) => {\n          submitForm(values, setSubmitting);\n        },\n        children: formik => {\n          const {\n            values,\n            handleChange,\n            handleSubmit,\n            errors,\n            touched,\n            handleBlur,\n            isSubmitting,\n            isValid,\n            dirty\n          } = formik;\n          return /*#__PURE__*/_jsxDEV(Form, {\n            children: [!isLoading && /*#__PURE__*/_jsxDEV(Box, {\n              mb: 2,\n              children: [/*#__PURE__*/_jsxDEV(Box, {\n                mb: 1,\n                ml: 0.5,\n                children: /*#__PURE__*/_jsxDEV(Typography, {\n                  component: \"label\",\n                  variant: \"caption\",\n                  children: \"Year\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 166,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(Select, {\n                labelId: \"demo-simple-select-label\",\n                id: \"demo-simple-select\",\n                value: selectedYear,\n                label: \"Year\",\n                onChange: handleChangeYear,\n                children: years.map((item, ind) => {\n                  return /*#__PURE__*/_jsxDEV(MenuItem, {\n                    value: item.id,\n                    children: item.year\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 178,\n                    columnNumber: 32\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 164,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              mb: 2,\n              children: [/*#__PURE__*/_jsxDEV(Box, {\n                mb: 1,\n                ml: 0.5,\n                children: /*#__PURE__*/_jsxDEV(Typography, {\n                  component: \"label\",\n                  variant: \"caption\",\n                  children: translate(\"Username\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 185,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(TextField, {\n                onChange: handleChange,\n                variant: \"outlined\",\n                size: \"small\",\n                type: \"text\",\n                id: \"username\",\n                name: \"username\",\n                value: values.username,\n                onBlur: handleBlur,\n                error: Boolean(touched.username && errors.username),\n                helperText: touched.username && errors.username,\n                placeholder: translate(\"Username\"),\n                fullWidth: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              mb: 2,\n              children: [/*#__PURE__*/_jsxDEV(Box, {\n                mb: 1,\n                ml: 0.5,\n                children: /*#__PURE__*/_jsxDEV(Typography, {\n                  component: \"label\",\n                  variant: \"caption\",\n                  children: translate(\"Password\")\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 226,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(TextField, {\n                id: \"password\",\n                name: \"password\",\n                type: \"password\",\n                variant: \"outlined\",\n                size: \"small\",\n                placeholder: translate(\"Password\"),\n                onChange: handleChange,\n                onBlur: handleBlur,\n                error: Boolean(errors.password && touched.password),\n                helperText: touched.password && errors.password,\n                fullWidth: true\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              display: \"flex\",\n              alignItems: \"center\",\n              children: [/*#__PURE__*/_jsxDEV(Switch, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(Typography, {\n                variant: \"button\",\n                style: {\n                  fontWeight: \"regular\",\n                  cursor: \"pointer\",\n                  userSelect: \"none\"\n                } // onClick={handleSetRememberMe}\n                // sx={{ cursor: \"pointer\", userSelect: \"none\" }}\n                ,\n                children: [\"\\xA0\\xA0\", translate(\"Remember me\")]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(Box, {\n              mt: 4,\n              mb: 1,\n              children: isSubmitting ? /*#__PURE__*/_jsxDEV(SuiButton, {\n                disabled: true,\n                variant: \"gradient\",\n                color: \"info\",\n                fullWidth: true,\n                children: translate(\"Signing in...\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(SuiButton, {\n                disabled: !(dirty && isValid),\n                type: \"submit\",\n                variant: \"gradient\",\n                color: \"info\",\n                fullWidth: true,\n                children: translate(\"Sign in\")\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 15\n          }, this);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 136,\n    columnNumber: 5\n  }, this) : () => {\n    router.push(\"/students_affairs/dashboard\");\n  };\n}\n\nexport default SignIn;","map":{"version":3,"sources":["F:/StudentAffairs/students/students/pages/authentication/sign-in/index.tsx"],"names":["React","useEffect","useState","Formik","Form","Yup","useRouter","CoverLayout","Box","Typography","TextField","Select","MenuItem","Switch","SuiButton","useSession","selectSessionKey","useAppDispatch","useAppSelector","setSessionKey","updateProfile","LoginService","useTranslation","bg7","require","SignIn","translate","locale","dispatch","rememberMe","setRememberMe","_currentSessionKey","setCurrentSessionKey","data","session","isUser","user","sessionKey","userProfile","router","push","isLoading","setLoading","years","setYears","selectedYear","setSelectedYear","initialValues","username","password","handleSetRememberMe","fetchApi","GetYears","console","log","handleChangeYear","event","target","value","status","SignInSchema","object","shape","string","required","min","submitForm","values","setSubmitting","Login","email","then","res","success","result","token","catch","err","error","navigateToDashboard","formik","handleChange","handleSubmit","errors","touched","handleBlur","isSubmitting","isValid","dirty","map","item","ind","id","year","Boolean","fontWeight","cursor","userSelect"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { Formik, Form } from \"formik\";\r\nimport * as Yup from \"yup\";\r\nimport { useRouter } from \"next/router\";\r\n// Authentication layout components\r\nimport CoverLayout from \"../../../components/CoverLayout\";\r\nimport {\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Select,\r\n  MenuItem,\r\n} from \"@material-ui/core\";\r\nimport { Switch } from \"@material-ui/core\";\r\nimport SuiButton from \"../../../components/SuiButton\";\r\nimport SuiInput from \"../../../components/SuiInput\";\r\nimport \"../../../assets/css/main.css\";\r\nimport { ISignInForm } from \"../../../Models/SignInForm\";\r\nimport { getProviders, getSession, signIn, useSession } from \"next-auth/react\";\r\nimport {\r\n  selectSessionKey,\r\n  useAppDispatch,\r\n  useAppSelector,\r\n  setSessionKey,\r\n  selectDirection,\r\n  updateProfile,\r\n} from \"../../../redux\";\r\nimport LoginService from \"../../../Services/LoginService\";\r\nimport { ApiResponse } from \"../../../Models/ApiResponse/ApiResponse\";\r\nimport { YearsModel } from \"../../../Models/ApiResponse/YearsModel\";\r\nimport { useTranslation } from \"../../../Utility/Translations/useTranslation\";\r\n// Images\r\nconst bg7 = require(\"./../../../assets/img/curved-images/HIAST.jpg\");\r\n\r\nfunction SignIn() {\r\n  const { translate } = useTranslation();\r\n  const { locale } = useRouter();\r\n\r\n  const dispatch = useAppDispatch();\r\n\r\n  const [rememberMe, setRememberMe] = useState(true);\r\n  const [_currentSessionKey, setCurrentSessionKey] = useState<string>(\"\");\r\n\r\n  const { data: session } = useSession();\r\n  const isUser = !!session?.user;\r\n  const sessionKey = useAppSelector(selectSessionKey);\r\n  const userProfile = useAppSelector(updateProfile);\r\n  useEffect(() => {\r\n    // console.log(\"session changed\", sessionKey);\r\n    // console.log(\"user profile changed\", userProfile);\r\n    if (!!sessionKey) router.push(\"/students_affairs/dashboard\");\r\n  }, [sessionKey]);\r\n\r\n  const [isLoading, setLoading] = useState(false);\r\n  const [years, setYears] = useState<YearsModel[]>([]);\r\n  const [selectedYear, setSelectedYear] = useState<string>(\"\");\r\n  const initialValues: ISignInForm = {\r\n    username: \"\",\r\n    // email: \"\",\r\n    password: \"\",\r\n    rememberMe: false,\r\n  };\r\n  const handleSetRememberMe = () => setRememberMe(!rememberMe);\r\n  const router = useRouter();\r\n\r\n  async function fetchApi() {\r\n    let data = (await LoginService.GetYears()) as ApiResponse;\r\n    console.log(\"years\", data);\r\n    return data;\r\n  }\r\n  const handleChangeYear = (event) => {\r\n    setSelectedYear(event.target.value as string);\r\n  };\r\n  useEffect(() => {\r\n    setLoading(true);\r\n  }, []);\r\n\r\n  const { status, data } = useSession();\r\n\r\n  // useEffect(() => {\r\n  //   console.log(\"status\", status);\r\n  //   console.log(\"data\", data);\r\n  //   if (status === \"authenticated\") router.replace(\"/\");\r\n  // }, [status]);\r\n\r\n  const SignInSchema = Yup.object().shape({\r\n    username: Yup.string().required(translate(\"{0} is required\", \"Username\")),\r\n    // .required(\"Email is required\"),\r\n    // email: Yup.string()\r\n    //   .email(\"Must be a valid email\")\r\n    //   .required(\"Email is required\"),\r\n    password: Yup.string()\r\n      .required(translate(\"{0} is required\", \"Password\"))\r\n      .min(\r\n        4,\r\n        translate(\r\n          \"Password is too short - should be {0} chars minimum\",\r\n          \"4\",\r\n          false\r\n        )\r\n      ),\r\n  });\r\n  const submitForm = async (values: any, setSubmitting) => {\r\n    console.log(\"values\", values);\r\n    LoginService.Login({\r\n      email: values.username,\r\n      password: values.password,\r\n    })\r\n      .then((res) => {\r\n        console.log(res);\r\n        if (res.success) {\r\n          console.log(\"sessionKey\", res.result.token);\r\n          console.log(\"userProfile\", res.result);\r\n          dispatch(setSessionKey(res.result.token));\r\n          dispatch(updateProfile(res.result));\r\n        }\r\n        console.log(\"sessionKey\", sessionKey);\r\n        console.log(\"userProfile\", userProfile);\r\n      })\r\n      .catch((err) => console.error(err));\r\n    // const resp = await signIn(\"credentials\", {\r\n    //   email: values.username,\r\n    //   password: values.password,\r\n    //   redirect: false,\r\n    // });\r\n    // console.log(resp);\r\n    // if (resp.ok) {\r\n    //   router.push(\"/student_affairs/dashboard\");\r\n    // } else {\r\n    // }\r\n  };\r\n  const navigateToDashboard = () => {\r\n    router.push(\"/students_affairs/dashboard\");\r\n  };\r\n  return !!sessionKey ? (\r\n    <CoverLayout\r\n      title={translate(\"Welcome\")}\r\n      description={translate(\"Enter your credentials to sign in\")}\r\n      image={bg7}\r\n    >\r\n      <Box>\r\n        <Formik\r\n          initialValues={initialValues}\r\n          validationSchema={SignInSchema}\r\n          onSubmit={(values, { setSubmitting }) => {\r\n            submitForm(values, setSubmitting);\r\n          }}\r\n        >\r\n          {(formik) => {\r\n            const {\r\n              values,\r\n              handleChange,\r\n              handleSubmit,\r\n              errors,\r\n              touched,\r\n              handleBlur,\r\n              isSubmitting,\r\n              isValid,\r\n              dirty,\r\n            } = formik;\r\n            return (\r\n              <Form>\r\n                {!isLoading && (\r\n                  <Box mb={2}>\r\n                    <Box mb={1} ml={0.5}>\r\n                      <Typography component=\"label\" variant=\"caption\">\r\n                        Year\r\n                      </Typography>\r\n                    </Box>\r\n                    <Select\r\n                      labelId=\"demo-simple-select-label\"\r\n                      id=\"demo-simple-select\"\r\n                      value={selectedYear}\r\n                      label=\"Year\"\r\n                      onChange={handleChangeYear}\r\n                    >\r\n                      {years.map((item, ind) => {\r\n                        return <MenuItem value={item.id}>{item.year}</MenuItem>;\r\n                      })}\r\n                    </Select>\r\n                  </Box>\r\n                )}\r\n                <Box mb={2}>\r\n                  <Box mb={1} ml={0.5}>\r\n                    <Typography component=\"label\" variant=\"caption\">\r\n                      {translate(\"Username\")}\r\n                    </Typography>\r\n                  </Box>\r\n                  <TextField\r\n                    onChange={handleChange}\r\n                    variant=\"outlined\"\r\n                    size=\"small\"\r\n                    type=\"text\"\r\n                    id=\"username\"\r\n                    name=\"username\"\r\n                    value={values.username}\r\n                    onBlur={handleBlur}\r\n                    error={Boolean(touched.username && errors.username)}\r\n                    helperText={touched.username && errors.username}\r\n                    placeholder={translate(\"Username\")}\r\n                    fullWidth\r\n                  />\r\n                </Box>\r\n                {/* <Box mb={1} ml={0.5}>\r\n                    <Typography component=\"label\" variant=\"caption\">\r\n                      Username\r\n                    </Typography>\r\n                  </Box>\r\n                  <TextField\r\n                    onChange={handleChange}\r\n                    variant=\"outlined\"\r\n                    size=\"small\"\r\n                    type=\"email\"\r\n                    id=\"email\"\r\n                    name=\"email\"\r\n                    value={values.email}\r\n                    onBlur={handleBlur}\r\n                    error={Boolean(touched.email && errors.email)}\r\n                    helperText={touched.email && errors.email}\r\n                    placeholder=\"example@hiast.edu.sy\"\r\n                    fullWidth\r\n                  />\r\n                </Box> */}\r\n                <Box mb={2}>\r\n                  <Box mb={1} ml={0.5}>\r\n                    <Typography component=\"label\" variant=\"caption\">\r\n                      {translate(\"Password\")}\r\n                    </Typography>\r\n                  </Box>\r\n                  <TextField\r\n                    id=\"password\"\r\n                    name=\"password\"\r\n                    type=\"password\"\r\n                    variant=\"outlined\"\r\n                    size=\"small\"\r\n                    placeholder={translate(\"Password\")}\r\n                    onChange={handleChange}\r\n                    onBlur={handleBlur}\r\n                    error={Boolean(errors.password && touched.password)}\r\n                    helperText={touched.password && errors.password}\r\n                    fullWidth\r\n                  />\r\n                </Box>\r\n                <Box display=\"flex\" alignItems=\"center\">\r\n                  <Switch />\r\n                  <Typography\r\n                    variant=\"button\"\r\n                    style={{\r\n                      fontWeight: \"regular\",\r\n                      cursor: \"pointer\",\r\n                      userSelect: \"none\",\r\n                    }}\r\n                    // onClick={handleSetRememberMe}\r\n                    // sx={{ cursor: \"pointer\", userSelect: \"none\" }}\r\n                  >\r\n                    &nbsp;&nbsp;{translate(\"Remember me\")}\r\n                  </Typography>\r\n                </Box>\r\n                <Box mt={4} mb={1}>\r\n                  {isSubmitting ? (\r\n                    <SuiButton\r\n                      disabled={true}\r\n                      variant=\"gradient\"\r\n                      color=\"info\"\r\n                      fullWidth\r\n                    >\r\n                      {translate(\"Signing in...\")}\r\n                    </SuiButton>\r\n                  ) : (\r\n                    <SuiButton\r\n                      disabled={!(dirty && isValid)}\r\n                      type=\"submit\"\r\n                      variant=\"gradient\"\r\n                      color=\"info\"\r\n                      fullWidth\r\n                    >\r\n                      {translate(\"Sign in\")}\r\n                    </SuiButton>\r\n                  )}\r\n                </Box>\r\n              </Form>\r\n            );\r\n          }}\r\n        </Formik>\r\n      </Box>\r\n    </CoverLayout>\r\n  ) : (\r\n    () => {\r\n      router.push(\"/students_affairs/dashboard\");\r\n    }\r\n  );\r\n}\r\nexport default SignIn;\r\n"]},"metadata":{},"sourceType":"module"}