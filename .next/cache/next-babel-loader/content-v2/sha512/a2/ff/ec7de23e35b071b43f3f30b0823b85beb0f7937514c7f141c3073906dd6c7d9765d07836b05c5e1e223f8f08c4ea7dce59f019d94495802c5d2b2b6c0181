{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport NextAuth from \"next-auth\";\nimport CredentialsProvider from \"next-auth/providers/credentials\";\nimport axios from \"../../../Services/ApiClient\";\nimport { useAppDispatch, setSessionKey } from \"../../../redux\"; //Api route function that is returned from next auth\n\nconst authOptions = {\n  secret: process.env.NextAuth_SECRET,\n  session: {\n    strategy: \"jwt\"\n  },\n  providers: [CredentialsProvider({\n    name: \"credentials\",\n    type: \"credentials\",\n    credentials: {\n      email: {\n        label: \"Email\",\n        type: \"text\",\n        placeholder: \"Enter email\"\n      },\n      password: {\n        label: \"Password\",\n        type: \"password\",\n        placeholder: \"Enter Password\"\n      }\n    },\n\n    async authorize(credentials, req) {\n      const payload = {\n        email: credentials.email,\n        password: credentials.password\n      };\n      alert(\"Starting the signup/login process ---\");\n      const response = await axios.post(\"/login\", payload).then(resp => {\n        console.log(\"resp\", resp);\n        if (resp.data.success) return resp.data;else console.log(resp.data.error);\n      }).catch(error => {\n        console.log(\"error resp\", error);\n      });\n      console.log(\"Credentials\", response);\n\n      if (response && response.success) {\n        let _user = {\n          name: response.result.userName,\n          img: response.result.image,\n          email: response.result.email,\n          token: response.result.token\n        };\n        console.log(response.result.token);\n        const dispatch = useAppDispatch();\n        dispatch(setSessionKey(response.result.token));\n        return _user;\n      } else return null;\n    }\n\n  })],\n  callbacks: {\n    async jwt({\n      token,\n      user\n    }) {\n      return _objectSpread(_objectSpread({}, token), user);\n    },\n\n    async session({\n      session,\n      token,\n      user\n    }) {\n      // Send properties to the client, like an access_token from a provider.\n      session.user = token;\n      return session;\n    }\n\n  },\n  pages: {\n    signIn: \"/authentication/sign-in\"\n  }\n};\nexport default NextAuth(authOptions);","map":{"version":3,"sources":["F:/StudentAffairs/students/students/pages/api/auth/[...nextauth].ts"],"names":["NextAuth","CredentialsProvider","axios","useAppDispatch","setSessionKey","authOptions","secret","process","env","NextAuth_SECRET","session","strategy","providers","name","type","credentials","email","label","placeholder","password","authorize","req","payload","alert","response","post","then","resp","console","log","data","success","error","catch","_user","result","userName","img","image","token","dispatch","callbacks","jwt","user","pages","signIn"],"mappings":"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","sourcesContent":["import NextAuth, { NextAuthOptions } from \"next-auth\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\nimport axios from \"../../../Services/ApiClient\";\r\nimport {\r\n  selectSessionKey,\r\n  useAppDispatch,\r\n  useAppSelector,\r\n  setSessionKey,\r\n  selectDirection,\r\n} from \"../../../redux\";\r\n//Api route function that is returned from next auth\r\nconst authOptions: NextAuthOptions = {\r\n  secret: process.env.NextAuth_SECRET,\r\n  session: {\r\n    strategy: \"jwt\",\r\n  },\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: \"credentials\",\r\n      type: \"credentials\",\r\n      credentials: {\r\n        email: {\r\n          label: \"Email\",\r\n          type: \"text\",\r\n          placeholder: \"Enter email\",\r\n        },\r\n        password: {\r\n          label: \"Password\",\r\n          type: \"password\",\r\n          placeholder: \"Enter Password\",\r\n        },\r\n      },\r\n      async authorize(credentials, req) {\r\n        const payload = {\r\n          email: credentials.email,\r\n          password: credentials.password,\r\n        };\r\n        alert(\"Starting the signup/login process ---\");\r\n        const response = await axios\r\n          .post(\"/login\", payload)\r\n          .then((resp) => {\r\n            console.log(\"resp\", resp);\r\n            if (resp.data.success) return resp.data;\r\n            else console.log(resp.data.error);\r\n          })\r\n          .catch((error) => {\r\n            console.log(\"error resp\", error);\r\n          });\r\n        console.log(\"Credentials\", response);\r\n        if (response && response.success) {\r\n          let _user = {\r\n            name: response.result.userName,\r\n            img: response.result.image,\r\n            email: response.result.email,\r\n            token: response.result.token,\r\n          };\r\n          console.log(response.result.token);\r\n          const dispatch = useAppDispatch();\r\n          dispatch(setSessionKey(response.result.token));\r\n          return _user;\r\n        } else return null;\r\n      },\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      return { ...token, ...user };\r\n    },\r\n    async session({ session, token, user }) {\r\n      // Send properties to the client, like an access_token from a provider.\r\n      session.user = token;\r\n      return session;\r\n    },\r\n  },\r\n  pages: {\r\n    signIn: \"/authentication/sign-in\",\r\n  },\r\n};\r\nexport default NextAuth(authOptions);\r\n"]},"metadata":{},"sourceType":"module"}