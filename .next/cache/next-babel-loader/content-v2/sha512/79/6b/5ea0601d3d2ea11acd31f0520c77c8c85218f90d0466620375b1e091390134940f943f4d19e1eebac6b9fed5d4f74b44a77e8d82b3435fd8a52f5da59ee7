{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useEffect, useState } from \"react\";\nimport GridContainer from \"../../../../../components/Grid/GridContainer\";\nimport GridItem from \"../../../../../components/Grid/GridItem\";\nimport { Button, FormControl, Grid, InputLabel, MenuItem, Select, Typography, makeStyles } from \"@material-ui/core\";\nimport Admin from \"../../../../../layouts/Admin\";\nimport { useTranslation } from \"../../../../../Utility/Translations/useTranslation\";\nimport styles from \"../../../../../assets/jss/nextjs-material-dashboard/views/rtlStyle.js\";\nimport { Add, ArrowBack, ZoomIn } from \"@material-ui/icons\";\nimport PlanCourses from \"../planCourses\";\nimport CourseService from \"../../../../../Services/CourseService\";\nimport SpecialityService from \"../../../../../Services/SpecialityService\";\nimport Router, { useRouter } from \"next/router\";\nimport SpecYearsService from \"../../../../../Services/SpecYearsService\";\nimport PlanService from \"../../../../../Services/PlanService\";\nimport { toast } from \"react-toastify\";\n\nconst SpcecifyCourses = () => {\n  var _router$query, _router$query2, _router$query5, _router$query6;\n\n  const {\n    translate\n  } = useTranslation();\n  const useStyles = makeStyles(styles);\n  const classes = useStyles(); // Programs\n\n  const {\n    0: programs,\n    1: setPrograms\n  } = useState([]);\n  const {\n    0: program,\n    1: setProgram\n  } = useState(null); // Courses\n\n  const {\n    0: courses,\n    1: setCourses\n  } = useState([]);\n  const {\n    0: course,\n    1: setCourse\n  } = useState(null); // Specialities\n\n  const {\n    0: specialities,\n    1: setSpecialities\n  } = useState([]);\n  const {\n    0: spec,\n    1: setSpec\n  } = useState(null); // Semester\n\n  const _sems = [{\n    id: 1,\n    value: \"الفصل الأول\"\n  }, {\n    id: 2,\n    value: \"الفصل الثاني\"\n  }];\n  const {\n    0: semesters,\n    1: setSemesters\n  } = useState(_sems);\n  const {\n    0: semester,\n    1: setSemester\n  } = useState(null); // Years ( Speciality Year)\n\n  const {\n    0: specYears,\n    1: setSpecYears\n  } = useState([]);\n  const {\n    0: specYear,\n    1: setSpecYear\n  } = useState(null); // Year\n\n  const router = useRouter();\n  const [year, setYear] = useState((_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.year);\n  const [eduYear, setEduYear] = useState((_router$query2 = router.query) === null || _router$query2 === void 0 ? void 0 : _router$query2.eduYear); // handle component route data\n\n  useEffect(() => {\n    var _router$query3, _router$query4;\n\n    setYear(router === null || router === void 0 ? void 0 : (_router$query3 = router.query) === null || _router$query3 === void 0 ? void 0 : _router$query3.year);\n    setEduYear(router === null || router === void 0 ? void 0 : (_router$query4 = router.query) === null || _router$query4 === void 0 ? void 0 : _router$query4.eduYear);\n  }, [(_router$query5 = router.query) === null || _router$query5 === void 0 ? void 0 : _router$query5.year, (_router$query6 = router.query) === null || _router$query6 === void 0 ? void 0 : _router$query6.eduYear]); // handle component api data\n\n  useEffect(() => {\n    PlanService.GetAll().then(programs => {\n      console.log(\"Program\", programs);\n      CourseService.GetAll().then(courses => {\n        SpecialityService.GetAll().then(specs => {\n          setPrograms(programs.result);\n          setCourses(courses.result);\n          setSpecialities(specs.result);\n          courses.result.length > 0 && setCourse(course.result[0].id);\n        }).catch(err => {});\n      }).catch(err => {});\n    }).catch(err => {\n      console.error(\"Error\", err);\n    });\n  }, []); // handle change speciality\n\n  const {\n    0: loadSpecYear,\n    1: setLoadSpecYear\n  } = useState(false);\n\n  const changeSpec = e => {\n    setLoadSpecYear(true);\n    setSpec(e.target.value);\n    SpecYearsService.GetWhereSpeciality(e.target.value).then(response => {\n      if (response.result && response.result.length > 0) {\n        console.clear();\n        console.log(response.result);\n\n        let _data = response.result.map(e => {\n          return {\n            id: e.id,\n            en_name: e.en_name,\n            ar_name: e.ar_name,\n            speciality_id: e.speciality_id\n          };\n        });\n\n        setSpecYears(_data);\n        setSpecYear(_data[0].id);\n      } else {\n        setSpecYears([]);\n        setSpecYear(null);\n      }\n\n      setLoadSpecYear(false);\n    }).catch(err => {\n      setSpecYears([]);\n      setSpecYear(null);\n      setLoadSpecYear(false);\n    });\n  }; // handle add coursse to program\n\n\n  const handleAddCourse = () => {\n    const payLoad = {\n      program_id: program,\n      year_id: specYear,\n      edu_year_id: year,\n      course_id: course,\n      semester: semester\n    };\n    PlanService.AddCourse(payLoad).then(result => {\n      if (result.success) {\n        toast.success(translate(\"Course Added To Plan Successfully\"));\n        PlanService.GetProgramCourses(program, specYear, year).then(resp => {\n          if (resp.success) {\n            setProgramCourses(resp.result);\n          }\n        }).catch(err => {});\n      }\n    }).catch(error => {\n      toast.error(error.message);\n    });\n  }; // handle routing back\n\n\n  const handleBack = e => {\n    e.preventDefault();\n    Router.push(\"/students_affairs/affairs_officer/initialize-year\");\n  }; // handle added courses to program\n  // Courses\n\n\n  const [programCourses, setProgramCourses] = React.useState([]);\n\n  const getProgramCourses = () => {\n    if (year && specYear && program) {\n      PlanService.GetProgramCourses(program, specYear, year).then(resp => {\n        if (resp.success) {\n          setProgramCourses(resp.result);\n        }\n      }).catch(err => {\n        toast.error(err.message);\n      });\n    } else {\n      toast.error(\"يجب تحديد البرنامج والسنة والاختصاص\");\n    }\n  }; // handle program courses\n\n\n  const changeProgram = val => {\n    setProgram(val);\n  };\n\n  return /*#__PURE__*/_jsxs(GridContainer, {\n    md: 12,\n    children: [/*#__PURE__*/_jsxs(GridContainer, {\n      md: 12,\n      children: [/*#__PURE__*/_jsx(GridItem, {\n        style: {\n          margin: \"-1em 0 1em 0\"\n        },\n        md: 12,\n        className: classes.typography,\n        children: /*#__PURE__*/_jsx(Typography, {\n          variant: \"h5\",\n          component: \"div\",\n          children: translate(`You're in the year`) + ` ${eduYear}`\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        style: {\n          margin: \"0 0 1em 0\"\n        },\n        md: 10,\n        className: classes.typography,\n        children: /*#__PURE__*/_jsxs(Typography, {\n          variant: \"h5\",\n          component: \"div\",\n          children: [translate(\"Year Plan\"), \" (\", translate(\"Specify Courses\"), \")\"]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"5px 5px\"\n          },\n          variant: \"contained\",\n          className: classes.warning,\n          onClick: handleBack,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"Back\")\n          }), /*#__PURE__*/_jsx(ArrowBack, {})]\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      md: 12,\n      style: {\n        margin: \"2em 0em\"\n      },\n      children: [/*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0628\\u0631\\u0646\\u0627\\u0645\\u062C\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: program,\n            label: \"programs\",\n            onChange: e => changeProgram(e.target.value),\n            children: programs === null || programs === void 0 ? void 0 : programs.map(program => /*#__PURE__*/_jsx(MenuItem, {\n              value: program.id,\n              children: program.name\n            }, program.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0645\\u0642\\u0631\\u0651\\u0631\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: course,\n            label: \"courses\",\n            onChange: e => setCourse(e.target.value),\n            children: courses.map(course => /*#__PURE__*/_jsx(MenuItem, {\n              value: course.id,\n              children: course.ar_name\n            }, course.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0627\\u062E\\u062A\\u0635\\u0627\\u0635\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: spec,\n            label: \"speciality\",\n            onChange: changeSpec,\n            children: specialities.map(spec => /*#__PURE__*/_jsx(MenuItem, {\n              value: spec.id,\n              children: spec.ar_name\n            }, spec.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0633\\u0646\\u0629\"\n          }), /*#__PURE__*/_jsx(Select, {\n            disabled: loadSpecYear,\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: specYear,\n            label: \"specYears\",\n            onChange: e => {\n              setSpecYear(e.target.value);\n            },\n            children: specYears.map(spYear => /*#__PURE__*/_jsx(MenuItem, {\n              value: spYear.id,\n              children: spYear.ar_name\n            }, spYear.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0641\\u0635\\u0644\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: semester,\n            label: \"speciality\",\n            onChange: e => setSemester(e.target.value),\n            children: semesters.map(sem => /*#__PURE__*/_jsx(MenuItem, {\n              value: sem.id,\n              children: sem.value\n            }, sem.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"10px 5px\"\n          },\n          variant: \"contained\",\n          className: classes.submitBtn,\n          onClick: handleAddCourse,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"Add\")\n          }), /*#__PURE__*/_jsx(Add, {})]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"10px 5px\"\n          },\n          variant: \"contained\",\n          className: classes.submitBtn,\n          onClick: getProgramCourses,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"Show Courses\")\n          }), /*#__PURE__*/_jsx(ZoomIn, {})]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(GridContainer, {\n      md: 12,\n      children: /*#__PURE__*/_jsx(GridItem, {\n        md: 12,\n        style: {\n          margin: \"1em 0 0 0\"\n        },\n        children: /*#__PURE__*/_jsx(PlanCourses, {\n          nofilter: false,\n          type: \"courses\",\n          programCourses: programCourses\n        }, \"Plan Courses\")\n      })\n    })]\n  });\n};\n\nSpcecifyCourses.layout = Admin;\nSpcecifyCourses.auth = false;\nexport default SpcecifyCourses;","map":null,"metadata":{},"sourceType":"module"}