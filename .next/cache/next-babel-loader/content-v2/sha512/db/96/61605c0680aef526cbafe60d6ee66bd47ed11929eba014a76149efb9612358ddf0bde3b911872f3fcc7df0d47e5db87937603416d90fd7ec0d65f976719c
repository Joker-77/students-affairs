{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React from \"react\";\nimport { Formik, Form } from \"formik\";\nimport { Modal, Box, Typography, IconButton, Grid, Button } from \"@material-ui/core\";\nimport { AttachFile, Close } from \"@material-ui/icons\";\nimport Card from \"../Card/Card.js\";\nimport CardHeader from \"../Card/CardHeader.js\";\nimport CardBody from \"../Card/CardBody.js\";\nimport SuiButton from \"../SuiButton\";\nimport { useRouter } from \"next/router\";\nimport { useTranslation } from \"../../Utility/Translations/useTranslation\";\nimport colors from \"../../assets/theme/base/colors\";\nimport * as Yup from \"yup\";\nimport RegisterationService from \"../../Services/RegisterationService\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport customstyles from \"../../assets/jss/nextjs-material-dashboard/views/rtlStyle\";\nimport { toast } from \"react-toastify\";\n\nconst AddTestResultsFileModal = ({\n  disabled = false,\n  title,\n  open,\n  submitForm,\n  handleClose\n}) => {\n  const {\n    locale\n  } = useRouter();\n  const {\n    translate\n  } = useTranslation();\n  const useStyles = makeStyles(customstyles);\n  const classes = useStyles();\n  const style = {\n    position: \"absolute\",\n    top: \"50%\",\n    left: \"50%\",\n    transform: \"translate(-50%, -50%)\",\n    width: \"40%\",\n    bgcolor: \"background.paper\",\n    // btype: \"2px solid brown\",\n    boxShadow: 24,\n    btypeRadius: \"20px\"\n  };\n  const cardStyle = {\n    position: \"absolute\",\n    //top: \"50%\",\n    //left: \"50%\",\n    //transform: \"translate(-50%, -50%)\",\n    // width: 700,\n    bgcolor: \"background.paper\",\n    // btype: \"2px solid brown\",\n    boxShadow: 24,\n    btypeRadius: \"20px\",\n    marginTop: \"0px\",\n    marginBottom: \"0px\"\n  };\n  const styles = {\n    modal: {\n      overflowY: \"scroll\",\n      overflowX: \"hidden\",\n      height: \"300px\",\n      direction: locale === 'ar' ? \"rtl\" : \"ltr\"\n    },\n    header: {\n      height: \"5em\",\n      position: \"sticky\",\n      btypeTopRightRadius: \"inherit\",\n      btypeTopLeftRadius: \"inherit\",\n      backgroundColor: colors.gradients.primary.main,\n      color: \"#fff\"\n    }\n  };\n  const [file, setFile] = React.useState(null);\n\n  const submitTestResults = async setSubmitting => {\n    setSubmitting(true);\n    RegisterationService.Add({\n      csv_file: file === null || file === void 0 ? void 0 : file.base64\n      /*.replace('data:text/csv;base64,', '')*/\n\n    }).then(res => {\n      submitForm();\n      toast(translate('Test results updated.'), {\n        type: 'success'\n      });\n    }).catch(error => {\n      console.error(\"error\", error);\n    }).finally(() => {\n      setSubmitting(false);\n    });\n    ;\n  };\n\n  const handleUpload = ({\n    target\n  }) => {\n    console.log('file: ', target.files[0]);\n    const fileReader = new FileReader();\n    fileReader.readAsDataURL(target.files[0]);\n\n    fileReader.onload = e => {\n      var _target$files$;\n\n      setFile({\n        name: (_target$files$ = target.files[0]) === null || _target$files$ === void 0 ? void 0 : _target$files$.name,\n        base64: e.target.result\n      });\n    };\n  };\n\n  return /*#__PURE__*/_jsx(Modal, {\n    open: open,\n    onClose: handleClose,\n    \"aria-labelledby\": \"modal-modal-title\",\n    \"aria-describedby\": \"modal-modal-description\",\n    children: /*#__PURE__*/_jsx(Box, {\n      sx: style,\n      style: styles.modal,\n      children: /*#__PURE__*/_jsxs(Card, {\n        style: cardStyle,\n        children: [/*#__PURE__*/_jsx(CardHeader, {\n          style: styles.header,\n          children: /*#__PURE__*/_jsxs(Grid, {\n            container: true,\n            children: [/*#__PURE__*/_jsx(Grid, {\n              md: 8,\n              children: /*#__PURE__*/_jsxs(\"h4\", {\n                style: {\n                  fontWeight: \"bold\"\n                },\n                children: [title, \" \"]\n              })\n            }), /*#__PURE__*/_jsx(Grid, {\n              md: 4,\n              children: /*#__PURE__*/_jsx(IconButton, {\n                style: {\n                  color: '#fff',\n                  position: \"absolute\",\n                  top: \"1em\",\n                  [locale === 'ar' ? 'left' : 'right']: \"2em\"\n                },\n                onClick: handleClose,\n                children: /*#__PURE__*/_jsx(Close, {})\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsx(CardBody, {\n          children: /*#__PURE__*/_jsx(Formik, {\n            initialValues: {},\n            validationSchema: Yup.object().shape({}),\n            onSubmit: (values, {\n              setSubmitting\n            }) => {\n              submitTestResults(setSubmitting);\n            },\n            children: formik => {\n              const {\n                isSubmitting\n              } = formik;\n              return /*#__PURE__*/_jsxs(Form, {\n                children: [/*#__PURE__*/_jsxs(Box, {\n                  mb: 2,\n                  children: [/*#__PURE__*/_jsx(Box, {\n                    mb: 1,\n                    ml: 0.5,\n                    children: /*#__PURE__*/_jsxs(Typography, {\n                      component: \"label\",\n                      variant: \"caption\",\n                      children: [translate(\"Results File\"), !!file && /*#__PURE__*/_jsxs(\"span\", {\n                        children: [\": \", file === null || file === void 0 ? void 0 : file.name]\n                      })]\n                    })\n                  }), /*#__PURE__*/_jsxs(Button, {\n                    disabled: isSubmitting,\n                    variant: \"contained\",\n                    className: classes.submitBtn,\n                    component: \"label\",\n                    style: {\n                      minWidth: 200,\n                      color: 'white'\n                    },\n                    children: [/*#__PURE__*/_jsx(AttachFile, {}), translate(\"Upload\"), \" \", translate(\"Results File\"), /*#__PURE__*/_jsx(\"input\", {\n                      accept: \".csv\",\n                      type: \"file\",\n                      name: 'csv_file',\n                      hidden: true,\n                      onChange: handleUpload\n                    })]\n                  })]\n                }), /*#__PURE__*/_jsx(Box, {\n                  mt: 4,\n                  mb: 1,\n                  children: isSubmitting ? /*#__PURE__*/_jsx(SuiButton, {\n                    disabled: true,\n                    variant: \"gradient\",\n                    color: \"info\",\n                    fullWidth: true,\n                    children: translate('Processing ...')\n                  }) : /*#__PURE__*/_jsx(SuiButton, {\n                    disabled: !file,\n                    type: \"submit\",\n                    variant: \"gradient\",\n                    color: \"info\",\n                    fullWidth: true,\n                    children: translate(\"Save\")\n                  })\n                })]\n              });\n            }\n          })\n        })]\n      })\n    })\n  });\n};\n\nexport default AddTestResultsFileModal;","map":null,"metadata":{},"sourceType":"module"}