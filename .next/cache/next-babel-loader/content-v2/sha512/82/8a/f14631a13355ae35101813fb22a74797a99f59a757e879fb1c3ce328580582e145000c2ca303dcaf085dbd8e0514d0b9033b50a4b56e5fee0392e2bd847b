{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport React, { useState, useEffect } from \"react\";\nimport Admin from \"../../../../layouts/Admin\";\nimport styles from \"../../../../assets/jss/nextjs-material-dashboard/views/rtlStyle.js\";\nimport GridContainer from \"../../../../components/Grid/GridContainer.js\";\nimport GridItem from \"../../../../components/Grid/GridItem.js\";\nimport { useTranslation } from \"../../../../Utility/Translations/useTranslation\";\nimport { useRouter } from \"next/router\";\nimport ExamService from \"../../../../Services/ExamService\";\nimport StudentsImportService from \"../../../../Services/StudentsImportService\";\nimport EduYearService from \"../../../../Services/EduYearService\";\nimport SpecialityService from \"../../../../Services/SpecialityService\";\nimport SpecYearsService from \"../../../../Services/SpecYearsService\";\nimport PlanService from \"../../../../Services/PlanService\";\nimport StudentListCourses from \"./list-students-course\";\nimport { toast } from \"react-toastify\";\nimport { Button, Dialog, DialogActions, DialogContent, DialogTitle, FormControl, Grid, InputLabel, MenuItem, Select, Typography, makeStyles } from \"@material-ui/core\";\nimport { AddBox } from \"@material-ui/icons\";\n\nvar StudentCourses = function StudentCourses(_ref) {\n  var _jsxs2, _jsxs3, _jsxs4, _jsxs5, _jsxs6;\n\n  _objectDestructuringEmpty(_ref);\n\n  var _useTranslation = useTranslation(),\n      translate = _useTranslation.translate;\n\n  var useStyles = makeStyles(styles);\n  var classes = useStyles();\n  var router = useRouter(); // Confirm Lock\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      confirm = _React$useState2[0],\n      setConfirm = _React$useState2[1];\n\n  var _React$useState3 = React.useState(false),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      lockMarks = _React$useState4[0],\n      setLockMarks = _React$useState4[1];\n\n  var handleShowConfirmLock = function handleShowConfirmLock() {\n    setConfirm(true);\n  };\n\n  var handleCloseConfirmLock = function handleCloseConfirmLock() {\n    setConfirm(false);\n  };\n\n  var handleLock = function handleLock() {}; // Lock Dialog\n\n\n  var ConfirmDialog = function ConfirmDialog() {\n    return /*#__PURE__*/_jsx(\"div\", {\n      children: /*#__PURE__*/_jsxs(Dialog, {\n        open: confirm,\n        onClose: handleCloseConfirmLock,\n        \"aria-labelledby\": \"alert-dialog-title\",\n        \"aria-describedby\": \"alert-dialog-description\",\n        children: [/*#__PURE__*/_jsx(DialogTitle, {\n          id: \"alert-dialog-title\",\n          children: translate(\"Delete a course\")\n        }), /*#__PURE__*/_jsx(DialogContent, {\n          children: /*#__PURE__*/_jsx(DialogContentText, {\n            id: \"alert-dialog-description\",\n            children: translate(\"Are you sure you want to delete this course\")\n          })\n        }), /*#__PURE__*/_jsxs(DialogActions, {\n          children: [/*#__PURE__*/_jsx(Button, {\n            onClick: handleLock,\n            children: translate(\"Yes\")\n          }), /*#__PURE__*/_jsx(Button, {\n            onClick: handleCloseConfirmLock,\n            autoFocus: true,\n            children: translate(\"No\")\n          })]\n        })]\n      })\n    });\n  };\n\n  var _React$useState5 = React.useState(0),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      value = _React$useState6[0],\n      setValue = _React$useState6[1];\n\n  var handleChange = function handleChange(event, newValue) {\n    setValue(newValue);\n  };\n\n  var _useState = useState([]),\n      eduYears = _useState[0],\n      setEduYears = _useState[1];\n\n  var _useState2 = useState([]),\n      years = _useState2[0],\n      setYears = _useState2[1];\n\n  var _useState3 = useState([]),\n      students = _useState3[0],\n      setStudents = _useState3[1];\n\n  var _useState4 = useState([]),\n      courses = _useState4[0],\n      setCourses = _useState4[1];\n\n  var _useState5 = useState([]),\n      studentCourses = _useState5[0],\n      setStudentCourses = _useState5[1];\n\n  var _React$useState7 = React.useState([]),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      specialities = _React$useState8[0],\n      setSpecialities = _React$useState8[1];\n\n  var _useState6 = useState(null),\n      selectedEduYear = _useState6[0],\n      setEduYear = _useState6[1];\n\n  var _useState7 = useState(null),\n      selectedYear = _useState7[0],\n      setYear = _useState7[1];\n\n  var _useState8 = useState(null),\n      selectedStudent = _useState8[0],\n      setStudent = _useState8[1];\n\n  var _useState9 = useState(null),\n      selectedCourse = _useState9[0],\n      setCourse = _useState9[1];\n\n  var _useState10 = useState(null),\n      selectedSpeciality = _useState10[0],\n      setSpeciality = _useState10[1];\n\n  var _useState11 = useState(false),\n      loadSpecYears = _useState11[0],\n      setloadSpecYears = _useState11[1];\n\n  var _useState12 = useState(false),\n      loadStuds = _useState12[0],\n      setloadStuds = _useState12[1];\n\n  var _useState13 = useState(false),\n      loadCourses = _useState13[0],\n      setLoadCourses = _useState13[1]; // Programs\n\n\n  var _useState14 = useState([]),\n      programs = _useState14[0],\n      setPrograms = _useState14[1];\n\n  var _useState15 = useState(null),\n      program = _useState15[0],\n      setProgram = _useState15[1];\n\n  var handleCreate = function handleCreate() {\n    var ids = studentCourses.map(function (e) {\n      return e.edu_course_id;\n    });\n\n    if (ids.includes(selectedCourse)) {\n      toast.error(\"المقرر موجود ضمن مقرّرات الطالب\");\n    } else {\n      var data = new FormData();\n      data.append(\"student_id\", selectedStudent);\n      data.append(\"edu_year_id\", selectedEduYear);\n      data.append(\"edu_course_id\", selectedCourse);\n      StudentsImportService.AddStudentCourss(data).then(function (e) {\n        var stCourses = studentCourses.slice();\n        stCourses.push(e.result[0]);\n        StudentsImportService.GetStudentCourses(selectedStudent, selectedEduYear).then(function (resp) {\n          setStudentCourses(resp.result);\n        }).catch(function (e) {});\n        toast.success(\"تمت إضافة المقرر بنجاح\");\n      }).catch(function (e) {\n        return toast.error(e.message);\n      });\n    }\n  };\n\n  var changeSpeciality = function changeSpeciality(id) {\n    setSpeciality(id);\n    setloadSpecYears(true);\n    SpecYearsService.GetWhereSpeciality(id).then(function (resp) {\n      setYears(resp.result);\n      setloadSpecYears(false);\n    }).catch(function (er) {});\n  };\n\n  var changeCourse = function changeCourse(id) {\n    setCourse(id);\n  };\n\n  var changeStudent = function changeStudent(id) {\n    setStudent(id);\n\n    if (selectedEduYear) {\n      StudentsImportService.GetStudentCourses(id, selectedEduYear).then(function (resp) {\n        setStudentCourses(resp.result);\n      }).catch(function (e) {});\n    }\n  };\n\n  var changeEduYear = function changeEduYear(id) {\n    setEduYear(id);\n    setLoadCourses(true);\n    ExamService.GetAllCourses(program, id).then(function (resp) {\n      setCourses(resp.result);\n      setLoadCourses(false);\n    }).catch(function (error) {});\n  };\n\n  var changeYear = function changeYear(id) {\n    setYear(id);\n    StudentsImportService.GetAllImported(id, selectedEduYear).then(function (resp) {\n      console.clear();\n      console.log(resp);\n      setStudents(resp.result);\n    }).catch(function (err) {});\n  };\n\n  var changeProgram = function changeProgram(id) {\n    setProgram(id);\n  };\n\n  useEffect(function () {\n    PlanService.GetAll().then(function (programs) {\n      setPrograms(programs.result);\n      EduYearService.GetYears(\"\").then(function (years) {\n        SpecialityService.GetAll().then(function (specs) {\n          setSpecialities(specs.result);\n        }).catch(function (err) {});\n        setEduYears(years.result);\n      }).catch(function (error) {\n        console.error(\"error\", error);\n      });\n    }).catch(function (e) {});\n  }, []);\n  return /*#__PURE__*/_jsxs(GridContainer, {\n    children: [/*#__PURE__*/_jsx(GridContainer, {\n      md: 12,\n      children: /*#__PURE__*/_jsx(GridItem, {\n        style: {\n          margin: \"-1em 0 1em 0\"\n        },\n        md: 12,\n        className: classes.typography,\n        children: /*#__PURE__*/_jsx(Typography, {\n          variant: \"h5\",\n          component: \"div\",\n          children: \"\\u0645\\u0642\\u0631\\u0631\\u0627\\u062A \\u0627\\u0644\\u0637\\u0627\\u0644\\u0628\"\n        })\n      })\n    }), /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      md: 12,\n      style: {\n        margin: \"2em 0em\"\n      },\n      children: [/*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, (_jsxs2 = {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\"\n        }, _defineProperty(_jsxs2, \"size\", \"small\"), _defineProperty(_jsxs2, \"children\", [/*#__PURE__*/_jsx(InputLabel, {\n          id: \"demo-simple-select-label\",\n          children: \"\\u0627\\u0644\\u0628\\u0631\\u0646\\u0627\\u0645\\u062C\"\n        }), /*#__PURE__*/_jsx(Select, {\n          labelId: \"demo-simple-select-label\",\n          id: \"demo-simple-select\",\n          value: program,\n          label: \"program\",\n          onChange: function onChange(e) {\n            return changeProgram(e.target.value);\n          },\n          children: programs === null || programs === void 0 ? void 0 : programs.map(function (program) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: program.id,\n              children: program.name\n            }, program.id);\n          })\n        })]), _jsxs2))\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, (_jsxs3 = {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\"\n        }, _defineProperty(_jsxs3, \"size\", \"small\"), _defineProperty(_jsxs3, \"children\", [/*#__PURE__*/_jsx(InputLabel, {\n          id: \"demo-simple-select-label\",\n          children: \"\\u0627\\u0644\\u0639\\u0627\\u0645 \\u0627\\u0644\\u062F\\u0631\\u0627\\u0633\\u064A\"\n        }), /*#__PURE__*/_jsx(Select, {\n          labelId: \"demo-simple-select-label\",\n          id: \"demo-simple-select\",\n          value: selectedEduYear,\n          label: \"eduYears\",\n          onChange: function onChange(e) {\n            return changeEduYear(e.target.value);\n          },\n          children: eduYears === null || eduYears === void 0 ? void 0 : eduYears.map(function (year) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: year.id,\n              children: year.year\n            }, year.id);\n          })\n        })]), _jsxs3))\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, (_jsxs4 = {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\"\n        }, _defineProperty(_jsxs4, \"size\", \"small\"), _defineProperty(_jsxs4, \"children\", [/*#__PURE__*/_jsx(InputLabel, {\n          id: \"demo-simple-select-label\",\n          children: \"\\u0627\\u0644\\u0627\\u062E\\u062A\\u0635\\u0627\\u0635\"\n        }), /*#__PURE__*/_jsx(Select, {\n          labelId: \"demo-simple-select-label\",\n          id: \"demo-simple-select\",\n          value: selectedSpeciality,\n          label: \"specs\",\n          onChange: function onChange(e) {\n            return changeSpeciality(e.target.value);\n          },\n          children: specialities === null || specialities === void 0 ? void 0 : specialities.map(function (spec) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: spec.id,\n              children: spec.ar_name\n            }, spec.id);\n          })\n        })]), _jsxs4))\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, (_jsxs5 = {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\"\n        }, _defineProperty(_jsxs5, \"size\", \"small\"), _defineProperty(_jsxs5, \"children\", [/*#__PURE__*/_jsx(InputLabel, {\n          id: \"demo-simple-select-label\",\n          children: \"\\u0627\\u0644\\u0633\\u0646\\u0629\"\n        }), /*#__PURE__*/_jsx(Select, {\n          disabled: loadSpecYears,\n          labelId: \"demo-simple-select-label\",\n          id: \"demo-simple-select\",\n          value: selectedYear,\n          label: \"specs\",\n          onChange: function onChange(e) {\n            return changeYear(e.target.value);\n          },\n          children: years === null || years === void 0 ? void 0 : years.map(function (specYear) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: specYear.id,\n              children: specYear.ar_name\n            }, specYear.id);\n          })\n        })]), _jsxs5))\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0637\\u0627\\u0644\\u0628\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: selectedStudent,\n            label: \"students\",\n            onChange: function onChange(e) {\n              return changeStudent(e.target.value);\n            },\n            children: students.map(function (st) {\n              var _st$candidate$person, _st$candidate$father, _st$candidate$person2;\n\n              return /*#__PURE__*/_jsx(MenuItem, {\n                value: st.id,\n                children: \"\".concat((_st$candidate$person = st.candidate.person) === null || _st$candidate$person === void 0 ? void 0 : _st$candidate$person.first_name, \" \").concat((_st$candidate$father = st.candidate.father) === null || _st$candidate$father === void 0 ? void 0 : _st$candidate$father.first_name, \" \").concat((_st$candidate$person2 = st.candidate.person) === null || _st$candidate$person2 === void 0 ? void 0 : _st$candidate$person2.last_name)\n              }, st.id);\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, (_jsxs6 = {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\"\n        }, _defineProperty(_jsxs6, \"size\", \"small\"), _defineProperty(_jsxs6, \"children\", [/*#__PURE__*/_jsx(InputLabel, {\n          id: \"demo-simple-select-label\",\n          children: \"\\u0627\\u0644\\u0645\\u0642\\u0631\\u0651\\u0631\"\n        }), /*#__PURE__*/_jsx(Select, {\n          disabled: loadCourses,\n          labelId: \"demo-simple-select-label\",\n          id: \"demo-simple-select\",\n          value: selectedCourse,\n          label: \"courses\",\n          onChange: function onChange(e) {\n            return changeCourse(e.target.value);\n          },\n          children: courses.map(function (course) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: course.edu_course_id,\n              children: course.ar_name\n            }, course.edu_course_id);\n          })\n        })]), _jsxs6))\n      }), /*#__PURE__*/_jsx(GridItem, {\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"10px 5px\"\n          },\n          disabled: false,\n          variant: \"contained\",\n          className: classes.submitBtn,\n          onClick: handleCreate,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"إضافة مقرر\")\n          }), /*#__PURE__*/_jsx(AddBox, {})]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(Grid, {\n      container: true,\n      md: 12,\n      style: {\n        margin: \"2em 0em\"\n      },\n      children: studentCourses && /*#__PURE__*/_jsx(StudentListCourses, {\n        courses: studentCourses\n      })\n    })]\n  });\n};\n\nStudentCourses.auth = true;\nStudentCourses.layout = Admin;\nexport default StudentCourses;","map":null,"metadata":{},"sourceType":"module"}