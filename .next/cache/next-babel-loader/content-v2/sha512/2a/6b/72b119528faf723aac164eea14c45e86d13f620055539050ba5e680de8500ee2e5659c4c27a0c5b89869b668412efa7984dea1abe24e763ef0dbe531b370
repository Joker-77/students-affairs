{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport React, { useEffect, useState } from \"react\";\nimport GridContainer from \"../../../../../components/Grid/GridContainer\";\nimport GridItem from \"../../../../../components/Grid/GridItem\";\nimport { Button, FormControl, Grid, InputLabel, MenuItem, Select, Typography, makeStyles } from \"@material-ui/core\";\nimport Admin from \"../../../../../layouts/Admin\";\nimport { useTranslation } from \"../../../../../Utility/Translations/useTranslation\";\nimport styles from \"../../../../../assets/jss/nextjs-material-dashboard/views/rtlStyle.js\";\nimport { Add, ArrowBack, ZoomIn } from \"@material-ui/icons\";\nimport PlanCourses from \"../planCourses\";\nimport CourseService from \"../../../../../Services/CourseService\";\nimport SpecialityService from \"../../../../../Services/SpecialityService\";\nimport Router, { useRouter } from \"next/router\";\nimport SpecYearsService from \"../../../../../Services/SpecYearsService\";\nimport PlanService from \"../../../../../Services/PlanService\";\nimport { toast } from \"react-toastify\";\n\nvar SpcecifyCourses = function SpcecifyCourses() {\n  var _router$query, _router$query2, _router$query5, _router$query6, _jsxs2, _jsxs3;\n\n  var _useTranslation = useTranslation(),\n      translate = _useTranslation.translate;\n\n  var useStyles = makeStyles(styles);\n  var classes = useStyles(); // Programs\n\n  var _useState = useState([]),\n      programs = _useState[0],\n      setPrograms = _useState[1];\n\n  var _useState2 = useState(null),\n      program = _useState2[0],\n      setProgram = _useState2[1]; // Courses\n\n\n  var _useState3 = useState([]),\n      courses = _useState3[0],\n      setCourses = _useState3[1];\n\n  var _useState4 = useState(null),\n      course = _useState4[0],\n      setCourse = _useState4[1]; // Specialities\n\n\n  var _useState5 = useState([]),\n      specialities = _useState5[0],\n      setSpecialities = _useState5[1];\n\n  var _useState6 = useState(null),\n      spec = _useState6[0],\n      setSpec = _useState6[1]; // Semester\n\n\n  var _sems = [{\n    id: 1,\n    value: \"الفصل الأول\"\n  }, {\n    id: 2,\n    value: \"الفصل الثاني\"\n  }];\n\n  var _useState7 = useState(_sems),\n      semesters = _useState7[0],\n      setSemesters = _useState7[1];\n\n  var _useState8 = useState(null),\n      semester = _useState8[0],\n      setSemester = _useState8[1]; // Years ( Speciality Year)\n\n\n  var _useState9 = useState([]),\n      specYears = _useState9[0],\n      setSpecYears = _useState9[1];\n\n  var _useState10 = useState(null),\n      specYear = _useState10[0],\n      setSpecYear = _useState10[1]; // Year\n\n\n  var router = useRouter();\n\n  var _ref = useState((_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.year),\n      _ref2 = _slicedToArray(_ref, 2),\n      year = _ref2[0],\n      setYear = _ref2[1];\n\n  var _ref3 = useState((_router$query2 = router.query) === null || _router$query2 === void 0 ? void 0 : _router$query2.eduYear),\n      _ref4 = _slicedToArray(_ref3, 2),\n      eduYear = _ref4[0],\n      setEduYear = _ref4[1]; // handle component route data\n\n\n  useEffect(function () {\n    var _router$query3, _router$query4;\n\n    setYear(router === null || router === void 0 ? void 0 : (_router$query3 = router.query) === null || _router$query3 === void 0 ? void 0 : _router$query3.year);\n    setEduYear(router === null || router === void 0 ? void 0 : (_router$query4 = router.query) === null || _router$query4 === void 0 ? void 0 : _router$query4.eduYear);\n  }, [(_router$query5 = router.query) === null || _router$query5 === void 0 ? void 0 : _router$query5.year, (_router$query6 = router.query) === null || _router$query6 === void 0 ? void 0 : _router$query6.eduYear]); // handle component api data\n\n  useEffect(function () {\n    PlanService.GetAll().then(function (programs) {\n      console.log(\"Program\", programs);\n      CourseService.GetAll().then(function (courses) {\n        SpecialityService.GetAll().then(function (specs) {\n          setPrograms(programs.result);\n          setCourses(courses.result);\n          setSpecialities(specs.result);\n          courses.result.length > 0 && setCourse(course.result[0].id);\n        }).catch(function (err) {});\n      }).catch(function (err) {});\n    }).catch(function (err) {\n      console.error(\"Error\", err);\n    });\n  }, []); // handle change speciality\n\n  var _useState11 = useState(false),\n      loadSpecYear = _useState11[0],\n      setLoadSpecYear = _useState11[1];\n\n  var changeSpec = function changeSpec(e) {\n    setLoadSpecYear(true);\n    setSpec(e.target.value);\n    SpecYearsService.GetWhereSpeciality(e.target.value).then(function (response) {\n      if (response.result && response.result.length > 0) {\n        console.clear();\n        console.log(response.result);\n\n        var _data = response.result.map(function (e) {\n          return {\n            id: e.id,\n            en_name: e.en_name,\n            ar_name: e.ar_name,\n            speciality_id: e.speciality_id\n          };\n        });\n\n        setSpecYears(_data);\n        setSpecYear(_data[0].id);\n      } else {\n        setSpecYears([]);\n        setSpecYear(null);\n      }\n\n      setLoadSpecYear(false);\n    }).catch(function (err) {\n      setSpecYears([]);\n      setSpecYear(null);\n      setLoadSpecYear(false);\n    });\n  }; // handle add coursse to program\n\n\n  var handleAddCourse = function handleAddCourse() {\n    var payLoad = {\n      program_id: program,\n      year_id: specYear,\n      edu_year_id: year,\n      course_id: course,\n      semester: semester\n    };\n    PlanService.AddCourse(payLoad).then(function (result) {\n      if (result.success) {\n        toast.success(translate(\"Course Added To Plan Successfully\"));\n        PlanService.GetProgramCourses(program, specYear, year).then(function (resp) {\n          if (resp.success) {\n            setProgramCourses(resp.result);\n          }\n        }).catch(function (err) {});\n      }\n    }).catch(function (error) {\n      toast.error(error.message);\n    });\n  }; // handle routing back\n\n\n  var handleBack = function handleBack(e) {\n    e.preventDefault();\n    Router.push(\"/students_affairs/affairs_officer/initialize-year\");\n  }; // handle added courses to program\n  // Courses\n\n\n  var _React$useState = React.useState([]),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      programCourses = _React$useState2[0],\n      setProgramCourses = _React$useState2[1];\n\n  var getProgramCourses = function getProgramCourses() {\n    if (year && specYear && program) {\n      PlanService.GetProgramCourses(program, specYear, year).then(function (resp) {\n        if (resp.success) {\n          setProgramCourses(resp.result);\n        }\n      }).catch(function (err) {\n        toast.error(err.message);\n      });\n    } else {\n      toast.error(\"يجب تحديد البرنامج والسنة والاختصاص\");\n    }\n  }; // handle program courses\n\n\n  var changeProgram = function changeProgram(val) {\n    setProgram(val);\n  };\n\n  return /*#__PURE__*/_jsxs(GridContainer, {\n    md: 12,\n    children: [/*#__PURE__*/_jsxs(GridContainer, {\n      md: 12,\n      children: [/*#__PURE__*/_jsx(GridItem, {\n        style: {\n          margin: \"-1em 0 1em 0\"\n        },\n        md: 12,\n        className: classes.typography,\n        children: /*#__PURE__*/_jsx(Typography, {\n          variant: \"h5\",\n          component: \"div\",\n          children: translate(\"You're in the year\") + \" \".concat(eduYear)\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        style: {\n          margin: \"0 0 1em 0\"\n        },\n        md: 10,\n        className: classes.typography,\n        children: /*#__PURE__*/_jsxs(Typography, {\n          variant: \"h5\",\n          component: \"div\",\n          children: [translate(\"Year Plan\"), \" (\", translate(\"Specify Courses\"), \")\"]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"5px 5px\"\n          },\n          variant: \"contained\",\n          className: classes.warning,\n          onClick: handleBack,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"Back\")\n          }), /*#__PURE__*/_jsx(ArrowBack, {})]\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      md: 12,\n      style: {\n        margin: \"2em 0em\"\n      },\n      children: [/*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, (_jsxs2 = {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\"\n        }, _defineProperty(_jsxs2, \"size\", \"small\"), _defineProperty(_jsxs2, \"children\", [/*#__PURE__*/_jsx(InputLabel, {\n          id: \"demo-simple-select-label\",\n          children: \"\\u0627\\u0644\\u0628\\u0631\\u0646\\u0627\\u0645\\u062C\"\n        }), /*#__PURE__*/_jsx(Select, {\n          labelId: \"demo-simple-select-label\",\n          id: \"demo-simple-select\",\n          value: program,\n          label: \"programs\",\n          onChange: function onChange(e) {\n            return changeProgram(e.target.value);\n          },\n          children: programs === null || programs === void 0 ? void 0 : programs.map(function (program) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: program.id,\n              children: program.name\n            }, program.id);\n          })\n        })]), _jsxs2))\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, (_jsxs3 = {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\"\n        }, _defineProperty(_jsxs3, \"size\", \"small\"), _defineProperty(_jsxs3, \"children\", [/*#__PURE__*/_jsx(InputLabel, {\n          id: \"demo-simple-select-label\",\n          children: \"\\u0627\\u0644\\u0645\\u0642\\u0631\\u0651\\u0631\"\n        }), /*#__PURE__*/_jsx(Select, {\n          labelId: \"demo-simple-select-label\",\n          id: \"demo-simple-select\",\n          value: course,\n          label: \"courses\",\n          onChange: function onChange(e) {\n            return setCourse(e.target.value);\n          },\n          children: courses.map(function (course) {\n            return /*#__PURE__*/_jsx(MenuItem, {\n              value: course.id,\n              children: course.ar_name\n            }, course.id);\n          })\n        })]), _jsxs3))\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0627\\u062E\\u062A\\u0635\\u0627\\u0635\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: spec,\n            label: \"speciality\",\n            onChange: changeSpec,\n            children: specialities.map(function (spec) {\n              return /*#__PURE__*/_jsx(MenuItem, {\n                value: spec.id,\n                children: spec.ar_name\n              }, spec.id);\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0633\\u0646\\u0629\"\n          }), /*#__PURE__*/_jsx(Select, {\n            disabled: loadSpecYear,\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: specYear,\n            label: \"specYears\",\n            onChange: function onChange(e) {\n              setSpecYear(e.target.value);\n            },\n            children: specYears.map(function (spYear) {\n              return /*#__PURE__*/_jsx(MenuItem, {\n                value: spYear.id,\n                children: spYear.ar_name\n              }, spYear.id);\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0641\\u0635\\u0644\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: semester,\n            label: \"speciality\",\n            onChange: function onChange(e) {\n              return setSemester(e.target.value);\n            },\n            children: semesters.map(function (sem) {\n              return /*#__PURE__*/_jsx(MenuItem, {\n                value: sem.id,\n                children: sem.value\n              }, sem.id);\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"10px 5px\"\n          },\n          variant: \"contained\",\n          className: classes.submitBtn,\n          onClick: handleAddCourse,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"Add\")\n          }), /*#__PURE__*/_jsx(Add, {})]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"10px 5px\"\n          },\n          variant: \"contained\",\n          className: classes.submitBtn,\n          onClick: getProgramCourses,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"Show Courses\")\n          }), /*#__PURE__*/_jsx(ZoomIn, {})]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(GridContainer, {\n      md: 12,\n      children: /*#__PURE__*/_jsx(GridItem, {\n        md: 12,\n        style: {\n          margin: \"1em 0 0 0\"\n        },\n        children: /*#__PURE__*/_jsx(PlanCourses, {\n          nofilter: false,\n          type: \"courses\",\n          programCourses: programCourses\n        }, \"Plan Courses\")\n      })\n    })]\n  });\n};\n\nSpcecifyCourses.layout = Admin;\nSpcecifyCourses.auth = false;\nexport default SpcecifyCourses;","map":null,"metadata":{},"sourceType":"module"}