{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport Admin from \"../../../../layouts/Admin\";\nimport Card from \"../../../../components/Card/Card.js\";\nimport CardHeader from \"../../../../components/Card/CardHeader.js\";\nimport CardBody from \"../../../../components/Card/CardBody.js\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport styles from \"../../../../assets/jss/nextjs-material-dashboard/views/rtlStyle.js\";\nimport { Grid } from \"@material-ui/core\";\nimport Desire from \"../../../../components/Desire/Desire\";\nimport { DragDropContext, Droppable, Draggable, resetServerContext } from \"react-beautiful-dnd\";\nimport { useTranslation } from \"../../../../Utility/Translations/useTranslation\";\nimport SpecialityService from \"../../../../Services/SpecialityService\";\nimport DesireService from \"../../../../Services/DesireService\";\nimport SuiButton from \"../../../../components/SuiButton\";\nimport { toast } from \"react-toastify\";\n\nvar CandidateDesireList = function CandidateDesireList(_ref) {\n  var candidateId = _ref.candidateId,\n      callback = _ref.callback,\n      updateCandidate = _ref.updateCandidate,\n      candidate = _ref.candidate;\n  resetServerContext();\n\n  var _useTranslation = useTranslation(),\n      translate = _useTranslation.translate;\n\n  var useStyles = makeStyles(styles);\n\n  var _React$useState = React.useState(null),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      Desires = _React$useState2[0],\n      setDesires = _React$useState2[1];\n\n  var _useState = useState({}),\n      columns = _useState[0],\n      setColumns = _useState[1];\n\n  var getSpecialities = function getSpecialities() {\n    SpecialityService.GetAll().then(function (res) {\n      console.log(\"Speciality\", res);\n      setColumns({\n        system: {\n          type: 1,\n          name: translate('Desires'),\n          items: res.result.map(function (item) {\n            return _objectSpread(_objectSpread({}, item), {}, {\n              id: item.id.toString()\n            });\n          })\n        }\n      });\n    }).catch(function (error) {\n      console.error(\"error\", error);\n    });\n  };\n  /************************** Data ****************************/\n\n\n  useEffect(function () {\n    DesireService.GetAll(candidateId).then(function (res) {\n      console.log(\"Desire\", res);\n      var desires = res.result;\n\n      if (desires.length > 0) {\n        setColumns({\n          system: {\n            type: 1,\n            name: translate('Desires'),\n            items: desires.filter(function (e) {\n              return e.speciality_id != 1;\n            }).map(function (item) {\n              return _objectSpread(_objectSpread({}, item.speciality), {}, {\n                id: item.speciality_id.toString()\n              });\n            })\n          }\n        });\n        console.log(\"desires\", desires.filter(function (e) {\n          return e.id != 1;\n        }));\n      } else {\n        getSpecialities();\n      }\n    }).catch(function (error) {\n      console.error(\"error\", error);\n    });\n  }, []);\n  /************************** Finish Data ****************************/\n\n  var _useState2 = useState(false),\n      isSubmitting = _useState2[0],\n      setSubmitting = _useState2[1];\n  /************************** Handle edit data ****************************/\n\n\n  var submitUpdateDesire = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var values;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setSubmitting(true);\n              console.log(\"items order: \", columns.system.items);\n              values = {\n                candidate_id: candidateId,\n                desires: columns.system.items.map(function (item, index) {\n                  return {\n                    speciality_id: item.id,\n                    order: index + 1\n                  };\n                })\n              };\n              DesireService.Save(values).then(function (res) {\n                console.log(\"Desire\", res);\n                updateCandidate(_objectSpread(_objectSpread({}, candidate), {}, {\n                  desires: res.result.map(function (e) {\n                    return e.speciality;\n                  })\n                }));\n                toast(translate('Desires updated.'), {\n                  type: 'success'\n                });\n                callback && callback(res.result);\n              }).catch(function (error) {\n                console.error(\"error\", error);\n              }).finally(function () {\n                setSubmitting(false);\n              });\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function submitUpdateDesire() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  /************************** Finish Edit Data ****************************/\n\n\n  var _onDragEnd = function onDragEnd(result, columns, setColumns) {\n    console.log(result, columns);\n    if (!result.destination) return;\n    var source = result.source,\n        destination = result.destination;\n    var column = columns[source.droppableId];\n\n    var copiedItems = _toConsumableArray(column.items);\n\n    var _copiedItems$splice = copiedItems.splice(source.index, 1),\n        _copiedItems$splice2 = _slicedToArray(_copiedItems$splice, 1),\n        removed = _copiedItems$splice2[0];\n\n    copiedItems.splice(destination.index, 0, removed);\n    setColumns(_objectSpread(_objectSpread({}, columns), {}, _defineProperty({}, source.droppableId, _objectSpread(_objectSpread({}, column), {}, {\n      items: copiedItems\n    }))));\n  };\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    children: /*#__PURE__*/_jsx(DragDropContext, {\n      onDragEnd: function onDragEnd(result) {\n        return _onDragEnd(result, columns, setColumns);\n      },\n      children: /*#__PURE__*/_jsx(Grid, {\n        container: true,\n        xs: 12,\n        md: 12,\n        sm: 12,\n        children: Object.entries(columns).map(function (_ref3, index) {\n          var _ref4 = _slicedToArray(_ref3, 2),\n              columnId = _ref4[0],\n              column = _ref4[1];\n\n          return /*#__PURE__*/_jsx(Grid, {\n            md: 12,\n            xs: 12,\n            sm: 12,\n            style: {\n              display: \"flex\",\n              flexDirection: \"column\",\n              alignItems: \"center\"\n            },\n            children: /*#__PURE__*/_jsxs(Card, {\n              children: [/*#__PURE__*/_jsx(CardHeader, {\n                children: /*#__PURE__*/_jsx(\"h4\", {\n                  style: {\n                    fontWeight: \"bold\",\n                    color: \"#01579b\"\n                  },\n                  children: column.name\n                })\n              }), /*#__PURE__*/_jsxs(CardBody, {\n                children: [/*#__PURE__*/_jsx(Droppable, {\n                  droppableId: columnId,\n                  children: function children(provided, snapshot) {\n                    return /*#__PURE__*/_jsxs(Grid, _objectSpread(_objectSpread({\n                      md: 12,\n                      container: true\n                    }, provided.droppableProps), {}, {\n                      ref: provided.innerRef,\n                      style: {\n                        background: snapshot.isDraggingOver ? \"rgb(1, 87, 155, 0.4)\" : \"rgba(211, 211, 211, 0.15)\",\n                        padding: 20,\n                        marginBottom: 20,\n                        borderRadius: 10\n                      },\n                      children: [column.items.map(function (item, index) {\n                        return /*#__PURE__*/_jsx(Draggable, {\n                          draggableId: item.id,\n                          index: index,\n                          children: function children(provided, snapshot) {\n                            return /*#__PURE__*/_jsx(Grid, _objectSpread(_objectSpread(_objectSpread({\n                              md: 12,\n                              ref: provided.innerRef\n                            }, provided.draggableProps), provided.dragHandleProps), {}, {\n                              style: _objectSpread({\n                                userSelect: \"none\",\n                                margin: \"3px 0 3px 0\",\n                                padding: \"0 20px\",\n                                borderRadius: \"12px\",\n                                backgroundColor: snapshot.isDragging ? \"#c2c2c2\" : \"white\",\n                                color: \"black\"\n                              }, provided.draggableProps.style),\n                              children: /*#__PURE__*/_jsx(Desire, {\n                                id: item.id,\n                                index: index,\n                                name: item.ar_short_name,\n                                type: column.type\n                              }, item.id)\n                            }));\n                          }\n                        }, item.id);\n                      }), provided.placeholder]\n                    }));\n                  }\n                }, columnId), isSubmitting ? /*#__PURE__*/_jsx(SuiButton, {\n                  disabled: true,\n                  variant: \"gradient\",\n                  color: \"info\",\n                  fullWidth: true,\n                  children: translate(\"Processing ...\")\n                }) : /*#__PURE__*/_jsx(SuiButton, {\n                  variant: \"gradient\",\n                  color: \"info\",\n                  fullWidth: true,\n                  onClick: submitUpdateDesire,\n                  children: translate(\"Save\")\n                })]\n              })]\n            })\n          }, columnId);\n        })\n      })\n    })\n  });\n};\n\nCandidateDesireList.auth = true;\nCandidateDesireList.layout = Admin;\nexport default CandidateDesireList;","map":null,"metadata":{},"sourceType":"module"}