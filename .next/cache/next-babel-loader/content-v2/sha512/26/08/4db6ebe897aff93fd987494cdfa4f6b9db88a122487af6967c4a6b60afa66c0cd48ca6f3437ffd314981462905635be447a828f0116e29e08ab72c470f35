{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from \"react\";\nimport Admin from \"../../../../layouts/Admin\";\nimport styles from \"../../../../assets/jss/nextjs-material-dashboard/views/rtlStyle.js\";\nimport GridContainer from \"../../../../components/Grid/GridContainer.js\";\nimport GridItem from \"../../../../components/Grid/GridItem.js\";\nimport { useTranslation } from \"../../../../Utility/Translations/useTranslation\";\nimport { useRouter } from \"next/router\";\nimport ExamService from \"../../../../Services/ExamService\";\nimport StudentsImportService from \"../../../../Services/StudentsImportService\";\nimport EduYearService from \"../../../../Services/EduYearService\";\nimport SpecialityService from \"../../../../Services/SpecialityService\";\nimport SpecYearsService from \"../../../../Services/SpecYearsService\";\nimport PlanService from \"../../../../Services/PlanService\";\nimport StudentListCourses from \"./list-students-course\";\nimport { toast } from \"react-toastify\";\nimport { Button, Dialog, DialogActions, DialogContent, DialogTitle, FormControl, Grid, InputLabel, MenuItem, Select, Typography, makeStyles } from \"@material-ui/core\";\nimport { AddBox } from \"@material-ui/icons\";\n\nconst StudentCourses = ({}) => {\n  const {\n    translate\n  } = useTranslation();\n  const useStyles = makeStyles(styles);\n  const classes = useStyles();\n  const router = useRouter(); // Confirm Lock\n\n  const [confirm, setConfirm] = React.useState(false);\n  const [lockMarks, setLockMarks] = React.useState(false);\n\n  const handleShowConfirmLock = () => {\n    setConfirm(true);\n  };\n\n  const handleCloseConfirmLock = () => {\n    setConfirm(false);\n  };\n\n  const handleLock = () => {}; // Lock Dialog\n\n\n  const ConfirmDialog = () => /*#__PURE__*/_jsx(\"div\", {\n    children: /*#__PURE__*/_jsxs(Dialog, {\n      open: confirm,\n      onClose: handleCloseConfirmLock,\n      \"aria-labelledby\": \"alert-dialog-title\",\n      \"aria-describedby\": \"alert-dialog-description\",\n      children: [/*#__PURE__*/_jsx(DialogTitle, {\n        id: \"alert-dialog-title\",\n        children: translate(\"Delete a course\")\n      }), /*#__PURE__*/_jsx(DialogContent, {\n        children: /*#__PURE__*/_jsx(DialogContentText, {\n          id: \"alert-dialog-description\",\n          children: translate(\"Are you sure you want to delete this course\")\n        })\n      }), /*#__PURE__*/_jsxs(DialogActions, {\n        children: [/*#__PURE__*/_jsx(Button, {\n          onClick: handleLock,\n          children: translate(\"Yes\")\n        }), /*#__PURE__*/_jsx(Button, {\n          onClick: handleCloseConfirmLock,\n          autoFocus: true,\n          children: translate(\"No\")\n        })]\n      })]\n    })\n  });\n\n  const [value, setValue] = React.useState(0);\n\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  const {\n    0: eduYears,\n    1: setEduYears\n  } = useState([]);\n  const {\n    0: years,\n    1: setYears\n  } = useState([]);\n  const {\n    0: students,\n    1: setStudents\n  } = useState([]);\n  const {\n    0: courses,\n    1: setCourses\n  } = useState([]);\n  const {\n    0: studentCourses,\n    1: setStudentCourses\n  } = useState([]);\n  const [specialities, setSpecialities] = React.useState([]);\n  const {\n    0: selectedEduYear,\n    1: setEduYear\n  } = useState(null);\n  const {\n    0: selectedYear,\n    1: setYear\n  } = useState(null);\n  const {\n    0: selectedStudent,\n    1: setStudent\n  } = useState(null);\n  const {\n    0: selectedCourse,\n    1: setCourse\n  } = useState(null);\n  const {\n    0: selectedSpeciality,\n    1: setSpeciality\n  } = useState(null);\n  const {\n    0: loadSpecYears,\n    1: setloadSpecYears\n  } = useState(false);\n  const {\n    0: loadStuds,\n    1: setloadStuds\n  } = useState(false);\n  const {\n    0: loadCourses,\n    1: setLoadCourses\n  } = useState(false); // Programs\n\n  const {\n    0: programs,\n    1: setPrograms\n  } = useState([]);\n  const {\n    0: program,\n    1: setProgram\n  } = useState(null);\n\n  const handleCreate = () => {\n    let ids = studentCourses.map(e => e.edu_course_id);\n\n    if (ids.includes(selectedCourse)) {\n      toast.error(\"المقرر موجود ضمن مقرّرات الطالب\");\n    } else {\n      let data = new FormData();\n      data.append(\"student_id\", selectedStudent);\n      data.append(\"edu_year_id\", selectedEduYear);\n      data.append(\"edu_course_id\", selectedCourse);\n      StudentsImportService.AddStudentCourss(data).then(e => {\n        let stCourses = studentCourses.slice();\n        stCourses.push(e.result[0]);\n        StudentsImportService.GetStudentCourses(selectedStudent, selectedEduYear).then(resp => {\n          setStudentCourses(resp.result);\n        }).catch(e => {});\n        toast.success(\"تمت إضافة المقرر بنجاح\");\n      }).catch(e => toast.error(e.message));\n    }\n  };\n\n  const changeSpeciality = id => {\n    setSpeciality(id);\n    setloadSpecYears(true);\n    SpecYearsService.GetWhereSpeciality(id).then(resp => {\n      setYears(resp.result);\n      setloadSpecYears(false);\n    }).catch(er => {});\n  };\n\n  const changeCourse = id => {\n    setCourse(id);\n  };\n\n  const changeStudent = id => {\n    setStudent(id);\n\n    if (selectedEduYear) {\n      StudentsImportService.GetStudentCourses(id, selectedEduYear).then(resp => {\n        setStudentCourses(resp.result);\n      }).catch(e => {});\n    }\n  };\n\n  const changeEduYear = id => {\n    setEduYear(id);\n    setLoadCourses(true);\n    ExamService.GetAllCourses(program, id).then(resp => {\n      setCourses(resp.result);\n      setLoadCourses(false);\n    }).catch(error => {});\n  };\n\n  const changeYear = id => {\n    setYear(id);\n    StudentsImportService.GetAllImported(id, selectedEduYear).then(resp => {\n      console.clear();\n      console.log(resp);\n      setStudents(resp.result);\n    }).catch(err => {});\n  };\n\n  const changeProgram = id => {\n    setProgram(id);\n  };\n\n  useEffect(() => {\n    PlanService.GetAll().then(programs => {\n      setPrograms(programs.result);\n      EduYearService.GetYears(\"\").then(years => {\n        SpecialityService.GetAll().then(specs => {\n          setSpecialities(specs.result);\n        }).catch(err => {});\n        setEduYears(years.result);\n      }).catch(error => {\n        console.error(\"error\", error);\n      });\n    }).catch(e => {});\n  }, []);\n  return /*#__PURE__*/_jsxs(GridContainer, {\n    children: [/*#__PURE__*/_jsx(GridContainer, {\n      md: 12,\n      children: /*#__PURE__*/_jsx(GridItem, {\n        style: {\n          margin: \"-1em 0 1em 0\"\n        },\n        md: 12,\n        className: classes.typography,\n        children: /*#__PURE__*/_jsx(Typography, {\n          variant: \"h5\",\n          component: \"div\",\n          children: `مقررات الطالب`\n        })\n      })\n    }), /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      md: 12,\n      style: {\n        margin: \"2em 0em\"\n      },\n      children: [/*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0628\\u0631\\u0646\\u0627\\u0645\\u062C\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: program,\n            label: \"program\",\n            onChange: e => changeProgram(e.target.value),\n            children: programs === null || programs === void 0 ? void 0 : programs.map(program => /*#__PURE__*/_jsx(MenuItem, {\n              value: program.id,\n              children: program.name\n            }, program.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0639\\u0627\\u0645 \\u0627\\u0644\\u062F\\u0631\\u0627\\u0633\\u064A\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: selectedEduYear,\n            label: \"eduYears\",\n            onChange: e => changeEduYear(e.target.value),\n            children: eduYears === null || eduYears === void 0 ? void 0 : eduYears.map(year => /*#__PURE__*/_jsx(MenuItem, {\n              value: year.id,\n              children: year.year\n            }, year.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0627\\u062E\\u062A\\u0635\\u0627\\u0635\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: selectedSpeciality,\n            label: \"specs\",\n            onChange: e => changeSpeciality(e.target.value),\n            children: specialities === null || specialities === void 0 ? void 0 : specialities.map(spec => /*#__PURE__*/_jsx(MenuItem, {\n              value: spec.id,\n              children: spec.ar_name\n            }, spec.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0633\\u0646\\u0629\"\n          }), /*#__PURE__*/_jsx(Select, {\n            disabled: loadSpecYears,\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: selectedYear,\n            label: \"specs\",\n            onChange: e => changeYear(e.target.value),\n            children: years === null || years === void 0 ? void 0 : years.map(specYear => /*#__PURE__*/_jsx(MenuItem, {\n              value: specYear.id,\n              children: specYear.ar_name\n            }, specYear.id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0637\\u0627\\u0644\\u0628\"\n          }), /*#__PURE__*/_jsx(Select, {\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: selectedStudent,\n            label: \"students\",\n            onChange: e => changeStudent(e.target.value),\n            children: students.map(st => {\n              var _st$candidate$person, _st$candidate$father, _st$candidate$person2;\n\n              return /*#__PURE__*/_jsx(MenuItem, {\n                value: st.id,\n                children: `${(_st$candidate$person = st.candidate.person) === null || _st$candidate$person === void 0 ? void 0 : _st$candidate$person.first_name} ${(_st$candidate$father = st.candidate.father) === null || _st$candidate$father === void 0 ? void 0 : _st$candidate$father.first_name} ${(_st$candidate$person2 = st.candidate.person) === null || _st$candidate$person2 === void 0 ? void 0 : _st$candidate$person2.last_name}`\n              }, st.id);\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        md: 2,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          size: \"small\",\n          size: \"small\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            id: \"demo-simple-select-label\",\n            children: \"\\u0627\\u0644\\u0645\\u0642\\u0631\\u0651\\u0631\"\n          }), /*#__PURE__*/_jsx(Select, {\n            disabled: loadCourses,\n            labelId: \"demo-simple-select-label\",\n            id: \"demo-simple-select\",\n            value: selectedCourse,\n            label: \"courses\",\n            onChange: e => changeCourse(e.target.value),\n            children: courses.map(course => /*#__PURE__*/_jsx(MenuItem, {\n              value: course.edu_course_id,\n              children: course.ar_name\n            }, course.edu_course_id))\n          })]\n        })\n      }), /*#__PURE__*/_jsx(GridItem, {\n        children: /*#__PURE__*/_jsxs(Button, {\n          style: {\n            margin: \"10px 5px\"\n          },\n          disabled: false,\n          variant: \"contained\",\n          className: classes.submitBtn,\n          onClick: handleCreate,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            style: {\n              padding: \"0px 0px 0px 10px\"\n            },\n            children: translate(\"إضافة مقرر\")\n          }), /*#__PURE__*/_jsx(AddBox, {})]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(Grid, {\n      container: true,\n      md: 12,\n      style: {\n        margin: \"2em 0em\"\n      },\n      children: studentCourses && /*#__PURE__*/_jsx(StudentListCourses, {\n        courses: studentCourses\n      })\n    })]\n  });\n};\n\nStudentCourses.auth = true;\nStudentCourses.layout = Admin;\nexport default StudentCourses;","map":null,"metadata":{},"sourceType":"module"}